"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6277],{78959:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.useLogger=void 0;let i=n(16463),r=n(95589),o=n(2265),s=n(51996);t.useLogger=function(e={}){let t=(0,i.usePathname)(),n=(0,s.useDeepCompareMemo)(()=>{var n;return Object.assign(Object.assign({},e),{args:Object.assign(Object.assign({},null!==(n=e.args)&&void 0!==n?n:{}),{path:t})})},[e,t]),a=(0,o.useMemo)(()=>new r.Logger(n),[n]);return(0,o.useEffect)(()=>()=>{a&&a.flush()},[t]),a}},86277:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.useLogger=t.withAxiomRouteHandler=t.withAxiomNextConfig=t.withAxiom=t.throttle=t.EndpointType=t.LogLevel=t.Logger=t.log=void 0;var o=n(95589);Object.defineProperty(t,"log",{enumerable:!0,get:function(){return o.log}}),Object.defineProperty(t,"Logger",{enumerable:!0,get:function(){return o.Logger}}),Object.defineProperty(t,"LogLevel",{enumerable:!0,get:function(){return o.LogLevel}});var s=n(12467);Object.defineProperty(t,"EndpointType",{enumerable:!0,get:function(){return s.EndpointType}}),Object.defineProperty(t,"throttle",{enumerable:!0,get:function(){return s.throttle}}),r(n(85015),t),r(n(62191),t);var a=n(89580);Object.defineProperty(t,"withAxiom",{enumerable:!0,get:function(){return a.withAxiom}}),Object.defineProperty(t,"withAxiomNextConfig",{enumerable:!0,get:function(){return a.withAxiomNextConfig}}),Object.defineProperty(t,"withAxiomRouteHandler",{enumerable:!0,get:function(){return a.withAxiomRouteHandler}}),r(n(57985),t);var u=n(78959);Object.defineProperty(t,"useLogger",{enumerable:!0,get:function(){return u.useLogger}})},95589:function(e,t,n){var i,r,o=n(25566),s=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(r,o){function s(e){try{u(i.next(e))}catch(e){o(e)}}function a(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}u((i=i.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.prettyPrint=t.log=t.Logger=t.LogLevel=void 0;let a=n(62191),u=n(12467),l=a.config.getLogsEndpoint(),g=o.env.NEXT_PUBLIC_AXIOM_LOG_LEVEL||"debug";(i=r||(t.LogLevel=r={}))[i.debug=0]="debug",i[i.info=1]="info",i[i.warn=2]="warn",i[i.error=3]="error",i[i.off=100]="off";class c{constructor(e={}){this.initConfig=e,this.logEvents=[],this.throttledSendLogs=(0,u.throttle)(this.sendLogs,1e3),this.children=[],this.logLevel=r.debug,this.config={autoFlush:!0,source:"frontend-log",prettyPrint:h},this.debug=(e,t={})=>{this._log(r.debug,e,t)},this.info=(e,t={})=>{this._log(r.info,e,t)},this.warn=(e,t={})=>{this._log(r.warn,e,t)},this.error=(e,t={})=>{this._log(r.error,e,t)},this.with=e=>{let t=new c(Object.assign(Object.assign({},this.config),{args:Object.assign(Object.assign({},this.config.args),e)}));return this.children.push(t),t},this.withRequest=e=>new c(Object.assign(Object.assign({},this.config),{req:Object.assign(Object.assign({},this.config.req),e)})),this._transformEvent=(e,t,n={})=>{let i={level:r[e].toString(),message:t,_time:new Date(Date.now()).toISOString(),source:this.config.source,fields:this.config.args||{},"@app":{"next-axiom-version":a.Version}};if(n instanceof Error)i.fields=Object.assign(Object.assign({},i.fields),{message:n.message,stack:n.stack,name:n.name});else if("object"==typeof n&&null!==n&&Object.keys(n).length>0){let e=JSON.parse(JSON.stringify(n,d));i.fields=Object.assign(Object.assign({},i.fields),e)}else n&&n.length&&(i.fields=Object.assign(Object.assign({},i.fields),{args:n}));return a.config.injectPlatformMetadata(i,this.config.source),null!=this.config.req&&(i.request=this.config.req,i.platform?i.platform.route=this.config.req.path:i.vercel&&(i.vercel.route=this.config.req.path)),i},this._log=(e,t,n={})=>{if(e<this.logLevel)return;let i=this._transformEvent(e,t,n);this.logEvents.push(i),this.config.autoFlush&&this.throttledSendLogs()},this.attachResponseStatus=e=>{this.logEvents=this.logEvents.map(t=>(t.request&&(t.request.statusCode=e),t))},this.flush=()=>s(this,void 0,void 0,function*(){yield Promise.all([this.sendLogs(),...this.children.map(e=>e.flush())])}),void 0!=this.initConfig.logLevel&&this.initConfig.logLevel>=0?this.logLevel=this.initConfig.logLevel:g&&(this.logLevel=r[g]),this.config=Object.assign(Object.assign({},this.config),e)}logHttpRequest(e,t,n,i){let r=this._transformEvent(e,t,i);r.request=n,this.logEvents.push(r),this.config.autoFlush&&this.throttledSendLogs()}middleware(e){var t;let n={ip:e.ip,region:null===(t=e.geo)||void 0===t?void 0:t.region,method:e.method,host:e.nextUrl.hostname,path:e.nextUrl.pathname,scheme:e.nextUrl.protocol.split(":")[0],referer:e.headers.get("Referer"),userAgent:e.headers.get("user-agent")},i=`[${e.method}] [middleware: "middleware"] ${e.nextUrl.pathname}`;return this.logHttpRequest(r.info,i,n,{})}sendLogs(){return s(this,void 0,void 0,function*(){if(!this.logEvents.length)return;if(!a.config.isEnvVarsSet()){this.logEvents.forEach(e=>this.config.prettyPrint?this.config.prettyPrint(e):h(e)),this.logEvents=[];return}let e=JSON.stringify(this.logEvents);this.logEvents=[];let t={"Content-Type":"application/json","User-Agent":"next-axiom/v"+a.Version};a.config.token&&(t.Authorization=`Bearer ${a.config.token}`);let i={body:e,method:"POST",keepalive:!0,headers:t};function r(){return fetch(l,i).catch(console.error)}try{if("undefined"==typeof fetch)return(yield n(42361))(l,i).catch(console.error);if(!a.isBrowser||!a.isVercelIntegration||!navigator.sendBeacon)return r();try{if(!navigator.sendBeacon.bind(navigator)(l,e))return r()}catch(e){return r()}}catch(t){console.warn(`Failed to send logs to Axiom: ${t}`),this.logEvents=[...this.logEvents,JSON.parse(e)]}})}}t.Logger=c,t.log=new c({});let f={info:{terminal:"32",browser:"lightgreen"},debug:{terminal:"36",browser:"lightblue"},warn:{terminal:"33",browser:"yellow"},error:{terminal:"31",browser:"red"}};function h(e){let t=Object.keys(e.fields).length>0;if(u.isNoPrettyPrint){let n=`${e.level} - ${e.message}`;t&&(n+=" "+JSON.stringify(e.fields)),console.log(n);return}let n="",i=[e.level,e.message];a.isBrowser?(n="%c%s - %s",i=[`color: ${f[e.level].browser};`,...i]):n=`\x1b[${f[e.level].terminal}m%s\x1b[0m - %s`,t&&(n+=" %o",i.push(e.fields)),e.request&&(n+=" %o",i.push(e.request)),console.log.apply(console,[n,...i])}function d(e,t){return t instanceof Error?Object.assign(Object.assign({},t),{name:t.name,message:t.message,stack:t.stack}):t}t.prettyPrint=h},85015:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},89580:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(r,o){function s(e){try{u(i.next(e))}catch(e){o(e)}}function a(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}u((i=i.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.withAxiom=t.withAxiomRouteHandler=t.withAxiomNextConfig=void 0;let r=n(62191),o=n(95589),s=n(12314),a=n(12467);function u(e){return Object.assign(Object.assign({},e),{rewrites:()=>i(this,void 0,void 0,function*(){var t;let n=yield null===(t=e.rewrites)||void 0===t?void 0:t.call(e),i=r.config.getIngestURL(a.EndpointType.webVitals),s=r.config.getIngestURL(a.EndpointType.logs);if(!i&&!s){let e=new o.Logger;return e.warn("axiom: Envvars not detected. If this is production please see https://github.com/axiomhq/next-axiom for help"),e.warn("axiom: Sending Web Vitals to /dev/null"),e.warn("axiom: Sending logs to console"),n||[]}let u=[{source:`${r.config.proxyPath}/web-vitals`,destination:i,basePath:!1},{source:`${r.config.proxyPath}/logs`,destination:s,basePath:!1}];return n?Array.isArray(n)?n.concat(u):(n.afterFiles=(n.afterFiles||[]).concat(u),n):u})})}function l(e){return(t,n)=>i(this,void 0,void 0,function*(){var i,a;let u="";"geo"in t&&(u=null!==(a=null===(i=t.geo)||void 0===i?void 0:i.region)&&void 0!==a?a:"");let l="";t instanceof s.NextRequest?l=t.nextUrl.pathname:t instanceof Request&&(l=new URL(t.url).pathname);let c={startTime:new Date().getTime(),endTime:new Date().getTime(),path:l,method:t.method,host:t.headers.get("host"),userAgent:t.headers.get("user-agent"),scheme:t.url.split("://")[0],ip:t.headers.get("x-forwarded-for"),region:u},f=new o.Logger({req:c,source:r.isEdgeRuntime?"edge":"lambda"}),h=f.with({});h.config.source=r.isEdgeRuntime?"edge-log":"lambda-log",t.log=h;try{let i=yield e(t,n);return c.endTime=new Date().getTime(),c.statusCode=i.status,c.durationMs=c.endTime-c.startTime,f.logHttpRequest(o.LogLevel.info,`[${t.method}] ${c.path} ${c.statusCode} ${c.endTime-c.startTime}ms`,c,{}),h.attachResponseStatus(i.status),yield f.flush(),r.isEdgeRuntime&&r.isVercelIntegration&&g(c),i}catch(e){throw c.endTime=new Date().getTime(),c.statusCode=500,c.durationMs=c.endTime-c.startTime,f.logHttpRequest(o.LogLevel.error,`[${t.method}] ${c.path} ${c.statusCode} ${c.endTime-c.startTime}ms`,c,{}),h.error(e.message,{error:e}),h.attachResponseStatus(500),yield f.flush(),r.isEdgeRuntime&&r.isVercelIntegration&&g(c),e}})}function g(e){console.log(`AXIOM_EDGE_REPORT::${JSON.stringify(e)}`)}t.withAxiomNextConfig=u,t.withAxiomRouteHandler=l,t.withAxiom=function(e){if("function"==typeof e);else if("object"==typeof e)return u(e);return l(e)}},42361:function(e,t){t.Headers=self.Headers,t.Request=self.Request,t.Response=self.Response,t.fetch=self.fetch},51996:function(e,t,n){n.r(t),n.d(t,{useDeepCompareCallback:function(){return u},useDeepCompareEffect:function(){return l},useDeepCompareImperativeHandle:function(){return g},useDeepCompareLayoutEffect:function(){return c},useDeepCompareMemo:function(){return f}});var i=n(2265),r=Object.prototype.hasOwnProperty;function o(e,t,n){for(n of e.keys())if(s(n,t))return n}function s(e,t){var n,i,a;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((i=e.length)===t.length)for(;i--&&s(e[i],t[i]););return -1===i}if(n===Set){if(e.size!==t.size)return!1;for(i of e)if((a=i)&&"object"==typeof a&&!(a=o(t,a))||!t.has(a))return!1;return!0}if(n===Map){if(e.size!==t.size)return!1;for(i of e)if((a=i[0])&&"object"==typeof a&&!(a=o(t,a))||!s(i[1],t.get(a)))return!1;return!0}if(n===ArrayBuffer)e=new Uint8Array(e),t=new Uint8Array(t);else if(n===DataView){if((i=e.byteLength)===t.byteLength)for(;i--&&e.getInt8(i)===t.getInt8(i););return -1===i}if(ArrayBuffer.isView(e)){if((i=e.byteLength)===t.byteLength)for(;i--&&e[i]===t[i];);return -1===i}if(!n||"object"==typeof e){for(n in i=0,e)if(r.call(e,n)&&++i&&!r.call(t,n)||!(n in t)||!s(e[n],t[n]))return!1;return Object.keys(t).length===i}}return e!=e&&t!=t}function a(e){let t=i.useRef(e),n=i.useRef(0);return s(e,t.current)||(t.current=e,n.current+=1),i.useMemo(()=>t.current,[n.current])}function u(e,t){return i.useCallback(e,a(t))}function l(e,t){i.useEffect(e,a(t))}function g(e,t,n){i.useImperativeHandle(e,t,a(n))}function c(e,t){i.useLayoutEffect(e,a(t))}function f(e,t){return i.useMemo(e,a(t))}}}]);